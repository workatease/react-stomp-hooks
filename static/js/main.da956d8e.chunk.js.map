{"version":3,"sources":["../../src/context/StompContext.tsx","../../src/components/StompSessionProvider.tsx","../../src/hooks/useSubscription.tsx","../../src/hooks/useStompClient.tsx","../../src/mock/subscriptions.tsx","../../src/mock/client.tsx","App.js","../../src/hoc/withStompClient.tsx","../../src/hoc/withSubscription.tsx","index.js"],"names":["StompContext","createContext","undefined","StompSessionProvider","props","url","children","stompClientOptions","stompOptions","_objectWithoutPropertiesLoose","useState","client","setClient","subscriptionRequests","useRef","Map","useEffect","_client","Client","brokerURL","webSocketFactory","parsedUrl","URL","window","_window","location","_window$location","href","protocol","SockJS","WebSocket","Error","onConnect","frame","current","forEach","value","subscription","subscribe","destination","callback","headers","onWebSocketClose","event","onStompError","activate","deactivate","Object","values","React","Provider","subscriptionId","Math","random","toString","substr","subscriptionRequest","set","connected","subscriptionData","get","unsubscribe","delete","useSubscription","destinations","onMessage","stompContext","useContext","callbackRef","_destinations","Array","isArray","cleanUpFunctions","_destination","push","message","_cleanUpFunction","useStompClient","context","App","debug","str","console","log","CssBaseline","Container","Card","style","margin","variant","CardContent","Typography","Showcase","title","Subscribing","SendingMessages","HigherOrderComponents","DynamicSubscription","lastMessage","setLastMessage","body","Box","input","setInput","stompClient","Grid","container","direction","spacing","item","Button","onClick","publish","TextField","onChange","target","WrappedComponent","ref","withSubscription","state","handleChange","bind","sendMessage","this","setState","Component","subscribed","setSubscribed","sx","width","display","justifyContent","Accordion","TransitionProps","unmountOnExit","AccordionSummary","expandIcon","id","AccordionDetails","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.da956d8e.chunk.js","sourcesContent":["import { createContext } from 'react';\nimport { StompSessionProviderContext } from '../interfaces/StompSessionProviderContext';\n\nconst StompContext = createContext<StompSessionProviderContext | undefined>(\n  undefined\n);\n\nexport default StompContext;\n","import React, { useEffect, useRef, useState } from 'react';\nimport StompContext from '../context/StompContext';\nimport SockJS from 'sockjs-client';\nimport {\n  Client,\n  IStompSocket,\n  messageCallbackType,\n  StompHeaders\n} from '@stomp/stompjs';\nimport { StompSessionProviderProps } from '../interfaces/StompSessionProviderProps';\nimport { StompSessionSubscription } from '../interfaces/StompSessionSubscription';\n\n/**\n * The StompSessionProvider manages the STOMP connection\n * All Hooks and HOCs in this library require an ancestor of this type.\n * The URL to connect to can be specified via the url prop.\n * Depending on the Schema of the URL either Sockjs or a raw Websocket is used.\n * You can override this behavior with the brokerURL or webSocketFactory props, which will then be forwarded to @stomp/stompjs\n * Custom @stomp/stompjs options can be used as props.\n * Please consult the @stomp/stompjs documentation for more information.\n */\nfunction StompSessionProvider(props: StompSessionProviderProps) {\n  let { url, children, stompClientOptions, ...stompOptions } = props;\n\n  // Support old API\n  if (stompClientOptions) stompOptions = stompClientOptions;\n\n  const [client, setClient] = useState<Client | undefined>(undefined);\n  const subscriptionRequests = useRef(new Map());\n\n  useEffect(() => {\n    const _client = new Client(stompOptions);\n\n    if (!stompOptions.brokerURL && !stompOptions.webSocketFactory) {\n      _client.webSocketFactory = function () {\n        const parsedUrl = new URL(url, window?.location?.href);\n        if (parsedUrl.protocol === 'http:' || parsedUrl.protocol === 'https:') {\n          return new SockJS(url) as IStompSocket;\n        } else if (\n          parsedUrl.protocol === 'ws:' ||\n          parsedUrl.protocol === 'wss:'\n        ) {\n          return new WebSocket(url) as IStompSocket;\n        } else throw new Error('Protocol not supported');\n      };\n    }\n\n    _client.onConnect = function (frame) {\n      if (stompOptions.onConnect) stompOptions.onConnect(frame);\n\n      subscriptionRequests.current.forEach((value) => {\n        value.subscription = _client.subscribe(\n          value.destination,\n          value.callback,\n          value.headers\n        );\n      });\n\n      setClient(_client);\n    };\n\n    _client.onWebSocketClose = function (event) {\n      if (stompOptions.onWebSocketClose) stompOptions.onWebSocketClose(event);\n\n      setClient(undefined);\n    };\n\n    if (!stompOptions.onStompError) {\n      _client.onStompError = function (frame) {\n        throw frame;\n      };\n    }\n\n    _client.activate();\n\n    return () => {\n      _client.deactivate();\n    };\n  }, [url, ...Object.values(stompOptions)]);\n\n  const subscribe = (\n    destination: string,\n    callback: messageCallbackType,\n    headers: StompHeaders = {}\n  ) => {\n    const subscriptionId = Math.random().toString(36).substr(2, 9);\n    const subscriptionRequest: StompSessionSubscription = {\n      destination,\n      callback,\n      headers\n    };\n\n    subscriptionRequests.current.set(subscriptionId, subscriptionRequest);\n\n    if (client && client.connected) {\n      subscriptionRequest.subscription = client.subscribe(\n        destination,\n        callback,\n        headers\n      );\n    }\n\n    return () => {\n      const subscriptionData = subscriptionRequests.current.get(subscriptionId);\n\n      if (subscriptionData.subscription) {\n        subscriptionData.subscription.unsubscribe();\n      }\n\n      subscriptionRequests.current.delete(subscriptionId);\n    };\n  };\n\n  return (\n    <StompContext.Provider\n      value={{\n        client,\n        subscribe\n      }}\n    >\n      {children}\n    </StompContext.Provider>\n  );\n}\n\nexport default StompSessionProvider;\n","import { useContext, useEffect, useRef } from 'react';\nimport StompContext from '../context/StompContext';\nimport { messageCallbackType, StompHeaders } from '@stomp/stompjs';\n\n/**\n *\n * @param destinations The destinations to subscribe to. Can be a string for a single destination or an array of strings for multiple.\n * @param onMessage Callback called when a message arrives for this subscription\n * @param headers Additional Headers for this subscription, consult @stomp/stompjs docs.\n */\nfunction useSubscription(\n  destinations: string | string[],\n  onMessage: messageCallbackType,\n  headers: StompHeaders = {}\n) {\n  const stompContext = useContext(StompContext);\n\n  if (stompContext === undefined)\n    throw new Error(\n      'There must be a StompSessionProvider as Ancestor of all Stomp Hooks and HOCs'\n    );\n\n  const callbackRef = useRef<messageCallbackType>(onMessage);\n  const _destinations = Array.isArray(destinations)\n    ? destinations\n    : [destinations];\n\n  callbackRef.current = onMessage;\n\n  useEffect(() => {\n    const cleanUpFunctions: (() => void)[] = [];\n\n    _destinations.forEach((_destination) =>\n      cleanUpFunctions.push(\n        stompContext.subscribe(\n          _destination,\n          (message) => {\n            callbackRef.current(message);\n          },\n          headers\n        )\n      )\n    );\n\n    return () => {\n      cleanUpFunctions.forEach((_cleanUpFunction) => {\n        _cleanUpFunction();\n      });\n    };\n  }, [\n    Object.values(_destinations).toString(),\n    Object.values(headers).toString()\n  ]);\n}\n\nexport default useSubscription;\n","import { useContext } from 'react';\nimport StompContext from '../context/StompContext';\nimport { StompSessionProviderContext } from '../interfaces/StompSessionProviderContext';\n\n/**\n * Returns the Stomp Client from @stomp/stompjs\n * This will be undefined if the client is currently not connected\n */\nfunction useStompClient() {\n  const context = useContext<StompSessionProviderContext | undefined>(\n    StompContext\n  );\n\n  if (context === undefined)\n    throw new Error(\n      'There must be a StompSessionProvider as Ancestor of all Stomp Hooks and HOCs'\n    );\n\n  return context.client;\n}\n\nexport default useStompClient;\n","import { IMessage } from '@stomp/stompjs/src/i-message';\nimport { messageCallbackType, StompHeaders } from '@stomp/stompjs';\n\nexport const subscriptions = new Map<string, Map<string, Function>>();\n\nexport function subscribeMock(\n  destination: string,\n  callback: messageCallbackType,\n  // @ts-ignore\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  headers: StompHeaders = {}\n) {\n  const subscriptionId = Math.random().toString(36).substr(2, 9);\n\n  if (!subscriptions.has(destination)) {\n    subscriptions.set(destination, new Map<string, Function>());\n  }\n\n  // @ts-ignore\n  subscriptions.get(destination).set(subscriptionId, callback);\n\n  return () => {\n    // @ts-ignore\n    subscriptions.get(destination).delete(subscriptionId);\n  };\n}\n\n/**\n * Simulates receiving a message from the server to the specified destination\n * @param destination The topic to send the message to\n * @param message The message to send\n */\nexport function mockReceiveMessage(\n  destination: string,\n  message: IMessage\n): void {\n  if (subscriptions.has(destination)) {\n    // @ts-ignore\n    subscriptions.get(destination).forEach((callback: Function) => {\n      callback(message);\n    });\n  }\n}\n\n/**\n * Gets the current subscriptions for the specified destination\n * @param destination The topic to get the subscriptions for, or undefined to get all subscriptions\n */\nexport function getMockSubscriptions(destination?: string) {\n  if (destination) {\n    return subscriptions.get(destination);\n  }\n  return subscriptions;\n}\n","import { IPublishParams } from '@stomp/stompjs';\n\nexport const messages = new Map<string, Array<IPublishParams>>();\n\n/**\n * A mock implementation of the publish function of the @stomp/stompjs client.\n * Will store the messages in a map, keyed by the destination.\n * @param params\n */\nexport function mockClientPublish(params: IPublishParams) {\n  if (!messages.has(params.destination)) {\n    messages.set(params.destination, []);\n  }\n\n  // @ts-ignore\n  messages.get(params.destination).push(params);\n}\n\n/**\n * Gets a default Mock of the @stomp/stompjs client.\n * If you require a custom client, you can use this as a base.\n */\nexport function getMockClient() {\n  return {\n    publish: mockClientPublish\n  };\n}\n\n/**\n * Gets all messages which have been sent via a mock client.\n * @param destination The destination to get messages for, or undefined to get all messages.\n */\nexport function getSentMockMessages(destination?: string) {\n  if (destination) {\n    return messages.get(destination);\n  }\n  return messages;\n}\n","import React, { useState } from \"react\";\n\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\n\nimport {\n  StompSessionProvider,\n  useStompClient,\n  useSubscription,\n  withStompClient,\n  withSubscription\n} from \"react-stomp-hooks\";\nimport {\n  Accordion,\n  AccordionDetails,\n  AccordionSummary,\n  Box,\n  Button,\n  Card,\n  CardContent,\n  Container,\n  Grid,\n  TextField,\n  Typography\n} from \"@material-ui/core\";\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\n\nexport function App() {\n  return (\n    //Initialize Stomp connection, will use sockjs, as the protocol specified is https\n    //The Connection can be used by all child components via the hooks or hocs.\n    <StompSessionProvider\n      url={\"https://stream.elite12.de/api/sock\"}\n      //All options supported by @stomp/stompjs can be used here\n      debug={(str) => {\n        console.log(str);\n      }}\n    >\n      <CssBaseline />\n      <Container>\n        <Card style={{ margin: \"3em\" }} variant=\"outlined\">\n          <CardContent>\n            <Typography>You can see the STOMP Messages send and received in the browser console</Typography>\n            <Typography>Note that, because the components are unmounted when the accordion is unexpanded, all subscriptions are removed when you close the accordion.</Typography>\n          </CardContent>\n        </Card>\n        <Showcase title={\"Subscribing\"}><Subscribing /></Showcase>\n        <Showcase title={\"Sending Messages\"}><SendingMessages /></Showcase>\n        <Showcase title={\"Higher Order Components\"}><HigherOrderComponents /></Showcase>\n        <Showcase title={\"Dynamic subscribing/unsubscribing\"}><DynamicSubscription /></Showcase>\n      </Container>\n    </StompSessionProvider>\n  );\n}\n\nexport function Subscribing() {\n  const [lastMessage, setLastMessage] = useState(\"No message received yet\");\n\n  //Subscribe to /topic/test, and use handler for all received messages\n  //Note that all subscriptions made through the library are automatically removed when their owning component gets unmounted.\n  //If the STOMP connection itself is lost they are however restored on reconnect.\n  //You can also supply an array as the first parameter, which will subscribe to all destinations in the array\n  useSubscription(\"/topic/test\", (message) => setLastMessage(message.body));\n\n  return (\n    <Box>Last Message: {lastMessage}</Box>\n  );\n}\n\nexport function SendingMessages() {\n  const [input, setInput] = useState(\"\");\n  const [lastMessage, setLastMessage] = useState(\"No message received yet\");\n\n  //Get Instance of StompClient\n  //This is the StompCLient from @stomp/stompjs\n  //Note: This will be undefined if the client is currently not connected\n  const stompClient = useStompClient();\n  useSubscription(\"/user/queue/echoreply\", (message) => setLastMessage(message.body));\n\n  const sendMessage = () => {\n    if(stompClient) {\n      //Send Message\n      stompClient.publish({\n        destination: \"/app/echo\",\n        body: \"Echo \" + input\n      });\n    }\n    else {\n      //Handle error\n    }\n  };\n\n  return (\n    <Grid container direction=\"row\" spacing={3}>\n      <Grid item><Button variant={\"contained\"} onClick={sendMessage}>Send Message</Button></Grid>\n      <Grid item><TextField variant=\"standard\" value={input}\n                            onChange={(event => setInput(event.target.value))} /></Grid>\n      <Grid item>\n        <Typography variant={\"body1\"}>\n          Last Message received: {lastMessage}\n        </Typography>\n      </Grid>\n    </Grid>\n  );\n}\n\nexport const HigherOrderComponents = withStompClient(withSubscription(\n  class HOCDemo extends React.Component {\n\n    constructor(props) {\n      super(props);\n\n      //stompCLient property is injected in the withStompClient HOC\n      this.stompClient = props.stompClient;\n      this.state = {\n        input: \"\",\n        lastMessage: \"No message received yet\"\n      };\n\n      this.handleChange = this.handleChange.bind(this);\n      this.sendMessage = this.sendMessage.bind(this);\n      this.onMessage = this.onMessage.bind(this);\n    }\n\n    //You have to specify an onMessage method for the withSubscription HOC.\n    onMessage(message) {\n      this.setState({\n        lastMessage: message.body\n      });\n    }\n\n    sendMessage() {\n      this.stompClient.publish({\n        destination: \"/app/echo\",\n        body: \"Echo \" + this.state.input\n      });\n    }\n\n    handleChange(event) {\n      this.setState({\n        input: event.target.value\n      });\n    }\n\n    render() {\n      return (\n        <Grid container direction=\"row\" spacing={3}>\n          <Grid item><Button variant={\"contained\"} onClick={this.sendMessage}>Send Message</Button></Grid>\n          <Grid item><TextField variant=\"standard\" value={this.state.input} onChange={this.handleChange} /></Grid>\n          <Grid item>\n            <Typography variant={\"body1\"}>\n              Last Message received: {this.state.lastMessage}\n            </Typography>\n          </Grid>\n        </Grid>\n      );\n    }\n  }, \"/user/queue/echoreply\")\n);\n\nexport function DynamicSubscription() {\n  const [lastMessage, setLastMessage] = useState(\"No message received yet\");\n  const [subscribed, setSubscribed] = useState(false);\n\n  useSubscription(\n    //The value of the first parameter can be mutated to dynamically subscribe/unsubscribe from topics\n    subscribed ? [\"/topic/test\"] : [],\n    (message) => setLastMessage(message.body)\n  );\n\n  return (\n    <Box sx={{width: '100%', display: 'flex', justifyContent: 'space-between'}}>\n      <Box>Last Message: {lastMessage}</Box>\n      <Box>\n        <Button onClick={() => setSubscribed(!subscribed)}>{subscribed ? \"Unsubscribe\" : \"Subscribe\"}</Button>\n      </Box>\n    </Box>\n  );\n}\n\nexport function Showcase(props) {\n  return (\n    <Accordion style={{ margin: \"3em\" }} TransitionProps={{ unmountOnExit: true }}>\n      <AccordionSummary\n        expandIcon={<ExpandMoreIcon />}\n        aria-controls=\"panel1a-content\"\n        id=\"panel1a-header\"\n      >\n        <Typography>{props.title}</Typography>\n      </AccordionSummary>\n      <AccordionDetails>\n        {props.children}\n      </AccordionDetails>\n    </Accordion>\n  );\n}\n","import React from 'react';\nimport useStompClient from '../hooks/useStompClient';\n\nfunction withStompClient<P>(WrappedComponent: React.ComponentType<P>) {\n  return (props: P) => {\n    const stompClient = useStompClient();\n    return <WrappedComponent stompClient={stompClient} {...props} />;\n  };\n}\n\nexport default withStompClient;\n","import React, { useRef } from 'react';\nimport useSubscription from '../hooks/useSubscription';\nimport { StompHeaders } from '@stomp/stompjs';\nimport {\n  MessageReceiverInterface,\n  StompMessageReceiver\n} from '../interfaces/StompMessageReceiver';\nimport { IMessage } from '@stomp/stompjs/esm6/i-message';\n\nfunction withSubscription<P>(\n  WrappedComponent: StompMessageReceiver<P>,\n  destinations: string | string[],\n  headers: StompHeaders = {}\n) {\n  return (props: P) => {\n    const ref = useRef<MessageReceiverInterface>();\n    useSubscription(\n      destinations,\n      (message: IMessage) => {\n        if (ref.current) ref.current.onMessage(message);\n      },\n      headers\n    );\n\n    // @ts-ignore\n    return <WrappedComponent ref={ref} {...props} />;\n  };\n}\n\nexport default withSubscription;\n","import './index.css'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport { App } from './App';\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}